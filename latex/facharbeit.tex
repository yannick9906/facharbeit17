% !TeX encoding = UTF-8

\documentclass[a4paper,12pt,ngerman]{scrartcl}      % Specifies the document class
\usepackage{minted}
\usemintedstyle{rainbow_dash}
\usepackage{german}
\usepackage{hyperref}
\usepackage[
type={CC},
modifier={by-nc-sa},
version={3.0},
]{doclicense}

% The preamble begins here.
\title{Webapps}  % Declares the document's title.

% Literaturverzeichnis
\usepackage[style=numeric, backend=bibtex, language=german]{biblatex}
\usepackage[nottoc]{tocbibind}
\addbibresource{literatur.bib}

% Deutsche Umlaute
\usepackage[utf8]{inputenc}

% Formatierung
\usepackage{xcolor}
\usepackage{sectsty}
\usepackage[sfdefault]{roboto}

\definecolor{myGreen}{HTML}{009688}
\chapterfont{\color{myGreen}}  % sets colour of chapters
\sectionfont{\color{myGreen}}  % sets colour of sections

\usepackage{geometry}
\geometry{a4paper, top=25mm, left=30mm, right=30mm, bottom=25mm, headsep=10mm, footskip=12mm}

\let\oldcite\cite
\renewcommand{\cite}[1]{\textsuperscript{\oldcite{#1}}}

\newcommand{\spacer}{\par\bigskip\noindent}
\providecommand{\inlinecode}[1]{\texttt{#1}}

\newcommand\invisiblesection[1]{
	\refstepcounter{section}
	\addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}%
	\sectionmark{#1}}

\begin{document}             % End of preamble and beginning of text.
	
	\begin{titlepage}
		\centering
		{\scshape\LARGE Gymnasium zum kurf\"{u}rstlichen Schloss zu Mainz \par}
		\vspace{1cm}
		{\scshape\Large Facharbeit\par}
		\vspace{2.5cm}
		{\huge\bfseries Webapps\par}
		\vspace{1cm}
		{\Large\itshape das Ergebnis moderner Webtechnologien\par}
		\vfill
		von\par
		Yannick \textsc{F\'elix}
		
		\vfill
		
		% Bottom of the page
		{\large 24. April 2017 \par}
		\newpage
	\end{titlepage}
	
	\setcounter{page}{1}
	\section{Kurzfassung}
	WebApps wurden von den meisten Benutzern, wenn auch unbewusst, benutzt. Oft fallen diese garnicht auf, da sie intuitiv zu benutzen sind.\par
	Immer dann, wenn wir eine Webseite benutzten können, ohne dabei die Webseite an sich zu verlassen, oder neuzuladen, handelt es sich um eine WebApp. Einige Beispiele sind die Google Suche, Google's Email Dienst GMail oder auch Facebook.\par
	Große Firmen stecken oft viel Geld und Ressourcen in die Entwicklung von nativen Apps für die beliebtesten Betriebssysteme, darunter Windows, Android und iOS. WebApps und auch deren Erweiterung progressive WebApps sind jedoch platformunabhängig und können auf jedem Betriebsystem benutzt werden. Somit genügt es eine Anwendung einmal als (progressive) WebApp zu entwickeln.\par
	Eine progressive WebApp ermöglicht es sogar den Eindruck zu erwecken, dass sie eine native App sei, ohne dabei auf bekannte Features, wie Offline-Modi und Push-Benachrichtigungen zu verzichten.\par
	Tut mir sehr leid, aber der ``Benutzerprofildienst'' ist heute leider nicht verfügbar.
	Selbst der ``Gruppenrichtlinienclient'' kann hier leider nichts mehr ausrichten...
	Versuche es in 42 Minuten erneut.\par

	\newpage
	
	\invisiblesection{Inhaltsverzeichnis}
	\tableofcontents
	\vfill
	\doclicenseThis
	
	\newpage
	\section{Geschichte und heutige Technologien}
	
	Bevor auf die Geschichte und verschieden Technologien eingegangen wird, muss zwischen zwei Typen von Sprachen unterschieden werden: Clientseitige Sprachen, welche beim Benutzer im Browser ausgeführt werden, und serverseitige Sprachen, welche der Server ausführt, bevor oder während einer Anfrage. \par
	
	\subsection{Clientseitige Sprachen}
	
	\textbf{HTML. Hypertext Markup Language.} Von Beginn des ``Internets'' an ist sie die Sprache zum grundlegenden Aufbau einer Webseite. Mit der Urversion von 1992 hat heutiges HTML nicht mehr viel zu tun. Damals war Hauptbestandteil der Text und dessen Verlinkung.\cite{htmlWiki}\par
	Über die Jahre hinweg hat sich HTML zu HTML5 respektive HTML5.1(seit Ende 2016 \cite{html51}) entwickelt. Letzteres beinhaltet vor allem Verbesserungen hinsichtlich Webapps, zum Beispiel die Einbindung von \grqq{responsive Images}, Bildern, welche dem Browser in verschieden Auflösungen zur Verfügung gestellt werden. Der Browser entscheidet dann, welche Auflösung passend für die anzuzeigende Größe ist und veringert somit den Datenverkehr. \cite{html51blog}  \par
	
	\spacer\textbf{JavaScript, kurz auch JS.} Ursprünglich LiveScript genannt wurde JavaScript entwickelt um dynamisches HTML zu erlauben. Hierbei wird das HTML-Dokument nach dem Laden beim Benutzer verändert. Der Name JavaScript rührt daher, dass LiveScript in Kooperation von Netscape und Sun Mircosystems entwickelt wurden. Um die Bekanntheit von Sun's Sprache Java zu nutzen wurde LiveScript in JavaScript umbenannt, obwohl es eigentlich wenig mit Java syntaxtechnisch zu tun hat. \cite{jsWiki}\par
	Heutzutage ist JavaScript Kernbestandteil von Webapps und handelt jegliche clientseitige Aktivität.\par
	Neben JS existieren bzw. existierten auch weitere Skriptsprachen, wie Flash und JavaApplets. Beide sind mittlerweile als obsolet markiert und stellen durch Sicherheitslücken ein hohes Sicherheitsrisiko dar.\cite{flashPlayer} Chrome hat diese, wie andere Browser auch, bereits standardmäßig deaktiviert.\cite{chromeNoFlash}\par
	
	\spacer\textbf{JSON, JavaScript Object Notation}, ist ein Standard um Objekte zwischen verschiedenen Programmiersprachen zu serialisieren.\par
	Vorteile von JSON gegenüber anderen Standards für einfachen Datenaustausch ist zum einen, dass es sowohl für Mensch, als auch für Maschine einfach zu lesen ist, zum anderen in praktisch jeder Programmiersprache ein Parser existiert um JSON-Objekte in respektive Objekte umzuwandeln. In JavaScript ist ein zusätzlicher Parser nicht von Nöten, da JSON eine valide JS Notation ist.\cite{json}\par
	Andere Standards zum Austausch von Daten sind zum Beispiel YAML und XML. Letzteres wird jedoch immer häufiger durch JSON ersetzt, da XML in der Kompilierung weit aus aufwendiger ist und für weniger Nutzdaten mehr Speicher benötigt.\par
	
	\spacer\textbf{AJAX, Asynchronous JavaScript and XML}, ist ein grundlegender Bestandteil moderner Webanwendungen. AJAX ermöglicht es, anders als der Name vermuten lässt, nicht nur XML sondern jegliche Daten vom Server asynchron, also nachdem die eigentliche HTML-Seite bereits geladen wurde, nachzuladen. Hierbei wird von JavaScript eine HTTP- bzw. HTTPs-Anfrage initiert, dessen Antwort daraufhin auch von JavaScript verarbeitet wird, um zum Beispiel Teile einer Seite zu aktualisieren, ohne die gesamte Seite neuladen zu müssen.\cite{ajaxWiki}\par
	
	\spacer\textbf{WebSockets}, werden, im Gegensatz zu AJAX-Verbindungen, aufrecht erhalten, um so schnell wie möglich Daten zwischen dem Server und dem Client austauschen zu können. Diese Technologie eignet sich vor allem für Echtzeitanwendungen, wie Livechats und Browserspiele\cite{websocketWiki}\par
	
	\subsection{Serverseitige Sprachen}
	
	\spacer\textbf{PHP, ``PHP: Hypertext Preprocessor''}, mittlerweile, mit über 80\% der Websites, die am weitesten verbreitetste serverseitige Skriptsprache.\cite{phpCoverage}\par
	PHP1, damals noch für \emph{Personal Home Page Tools}, wurde als Ersatz zu Perlskripten von Rasmus Lerdorf entwickelt. Mit PHP3, welches von Andi Gutmans und Zeev Suraski entwickelt wurde(Lerdorf wurde als Entwickler auch eingestellt), wurde die Sprache von Grund auf neu entwickelt und unter dem rekursiven Akronym \emph{PHP: Hypertext Preprocessor} veröffentlicht.\par
	Mit PHP4 war es zudem möglich objektorientiert zu Programmieren, welches mit PHP5 weiter verbessert wurde.\par
	Die aktuellste Version ist PHP7.1. Mit PHP7 kamen, 11 Jahre nach PHP5, vorallem eine verbesserte Performance und sowie einige neue Features dazu.\cite{phpWiki}\par
	
	\subsection{Webapp}
	Die Funktion einer interaktiven Webseite setzt die Möglichkeit vorraus, dass der Webserver Daten empfangen kann, die der Benutzer eingegeben hat. Bereits in der Ur-Version von HTML war es möglich Werte an den Webserver zu schicken, ähnlich dem heutigen HTTP-GET Verfahren. Eine der ersten Seiten war ``SPIRES-HEP'', ein Webinterface für eine Datenbank der Stanford Universität aus dem Jahr 1991.\par
	Die erste von der Öffentlichkeit wahrgenommene Webanwendung war Yahoo, welches ebenfalls an der Stanford Universität von zwei Studenten entwickelt wurde.\par
	Seit AJAX in JavaScript Einzug erhalten hat, ist es möglich auch dynamisch Teile der angezeigten Webseite zu verändern, oder sogar die Präsentationsschicht komplett auf den Client auszulagern, hierbei sendet während der normalen Benutzung der Server nur noch benötigte Informationen.\cite{webappWiki}\par
	Aktuell spricht man auch von ``Progressiven Web Apps'', wenn diese nicht nur komplett clientseitig ausgeführt werden können, sondern auch Features wie ein Offline-Modus und Push-Benachritigungen enthalten. Außerdem können diese den Eindruck erwecken, eine native App zu sein, obwohl keine Installation benötigt wird. Leider werden diese bisher nur von Chrome und Firefox unterstützt, andere Browser haben zum Zeitpunkt der Recherche angekündigt progressive WebApps in Zukunft zu unterstützen.\cite{prwebappWiki}\par
	
	\newpage
	\section{Entwicklung einer progressiven WebApp}
	\subsection{Vorbereitung}
	Zur Vorbereitung gehören neben der Einrichtung der Entwicklungsumgebung und des Webservers auch die Sammlung benötigter Bibliotheken.\par
	Bei der Einrichtung des Webservers wurde ein Ordner für dieses Projekt samt passender Zugriffsrechte und gültigen SSL-Zertifikat erstellt. Dieses Zertifikat ist nicht nur für die Funktionalität von Service Workern, bei welchen eine Verbindung via SSL Pflicht ist, sondern auch für den generellen Datenschutz des Nutzers wichtig.\par
	Als einfachste Serversoftware ist hier Caddyserver\footnote{\inlinecode{Caddyserver} - The HTTP/2 web server with automatic HTTPS: \url{https://caddyserver.com/}} von Vorteil. Dieser bietet nicht nur einfach Erweiterbarkeit, wie zum Beispiel für PHP, und gute Performance, sondern unterstützt schon das neue Protokoll HTTP/2 und kann automatisch SSL-Zertifikate für die eingerichteten Domains austellen lassen.\par
	\noindent Da eine Entwicklung ohne jegliche Bibliotheken viel zu lang dauern würde und nicht praktikabel ist wurden auch hier einige Bibliotheken verwendet:\par
	\spacer\textbf{Materialize CSS\footnote{\inlinecode{Materialize Frontend-Framework}: \url{http://materializecss.com/}}:} Dies ist eine CSS/JS-Bibliothek, welche jegliche Designelemente Googles Material Design Definition zur Verfügung stellt. Somit lassen sich ohne viel Aufwand, mittels HTML und passenden CSS-Klassen responsive Webseiten erstellen.\par
	\spacer\textbf{jQuery\footnote{\inlinecode{jQuery JavaScript Library}: \url{https://jquery.com/}}} ist eine der beliebtesten JavaScript-Bibliothek\cite{jQueryCoverage}, welche viele häufig benötigten JavaScript-Funktionen in einfachere, schnell zu benutztende Funktionen vereint.\par
	\spacer\textbf{Dexie.js\footnote{\inlinecode{dexie.js}: \url{http://dexie.org/}}:} Um auf eine der beliebtesten Web Datenbanken, IndexedDB zuzugreifen bietet dexie.js einfache, objektorientierte Methoden und Klassen.\par
	\spacer Einige kleinere JavaScript Funktionen wurde zusätzlich verwendet um zum Beispiel Hashfunktionen wie md5 auszuführen oder Graphen und Diagramme zu zeichnen.\par
	\subsection{Struktur}
	\subsubsection{JavaScript}
	...
	\subsubsection{Datenbank}
	...
	\subsubsection{Klassen in PHP}
	...
	\subsubsection{API}
	...
	\subsection{Entwicklungsprozess}
	Die Reihenfolge der einzelnen Schritte sind in den meisten Fällen persönliche Präferenz. In diesem Fall wird mit der Entwicklung des Clients begonnen, denn dieser soll, da er die eigentliche WebApp widerspiegelt, auch ohne Internetverbindung laufen. Die meiste serverseitige Entwicklung kann somit im Anschluss geschehen.\par
	
	\subsubsection{Client Grundlagen}
	Zunächst werden Grundlagen im JavaScript, also clientseitig gelegt. Ziel einer progressiven WebApp ist es, dass diese nicht nur aussieht, als sei sie eine native App, sondern auch ohne Datenverbindung funktioniert. Hierfür wird der Client an das Prinzip einer Single-Page-Webanwendung\cite{singlePageWiki} angelehnt. Somit wird nur selten die gesamte Seite neugeladen, sondern das Grundgerüst wird zu Beginn einer Sitzung geladen und jeder Inhalt wird von JavaScript mittels DOM-Manipulation dynamisch eingefügt.\par
	Der erste Schritt wird also mit dem Erstellen der Datei ``index.html'' getan. Diese enthält die sog. App-Shell, welche jenes Grundgerüst darstellt.\par
	Im Beispiel des Schulplaners ist es jedoch erwünscht die Login- / Registrierungsoberfläche von der ``App'' ansich abzugrenzen. Deshalb erhält die Datei ``index.html'' hier nicht dei App-Shell, sondern die Login-Maske. Für das Grundgerüst wird abweichend ``app.html'' verwendet.\par
	\spacer Die eigentliche Entwicklung dieses Grundgerüsts unterscheidet sich nicht stark von der einer herkömmlichen HTML- Webseite. Jedoch wird hier nur die Me\-nü\-füh\-rung und Kopfzeile erstellt. Der eigentliche Inhalt wird später mittels JavaScript eingefügt.
	
	\subsubsection{Das Manifest}
	Das Manifest ist der Bestandteil einer progressiven WebApp, der es (unter anderem) möglich macht, diese zum Homescreen hinzuzufügen.\par
	Es besteht aus einer JSON-Datei, welche in jedem HTML-Dokument einer WebApp im \inlinecode{<head>}-Bereich verlinkt sein muss. In dieser Datei werden neben dem Namen, Icons und der Start-URL auch Parameter zur Darstellung wie der Hauptfarbe und der Orientation festgelegt. Der Parameter \inlinecode{"{}display"{}: "{}standalone"{}} macht aus einer normalen Webseite eine ``echte'' WebApp, indem es jegliche UI-Elemente des Browsers verbergt und die Webseite wie eine native App aussehen lässt.\par
	
	\subsubsection{Der Service-Worker}
	Grundlegend ist ein Service-Worker ein JavaScript-Skript, welches vom Browser ``installiert'' wird. Das heißt der Browser speichert das Skript und führt dieses, nicht nur solange eine Seite bzw. Tab offen ist, sondern auch darüber hinaus, aus.\par
	In Google Chrome zum Beispiel funktionieren Service-Worker, genauso wie einige andere Funktionen, darunter Zugriff auf die Webcam oder den Standort, nur wenn die aufgerufene Seite ein ``secure Origin'' ist, hierbei \emph{muss} die Seite unter anderem vollständig über SSL ausgeliefert werden. Ausnahmen hierfür sind zu Entwicklungszwecken \inlinecode{localhost} und \inlinecode{127.0.0.1}. Außerdem darf pro Webseite nur ein Service-Worker existieren.\par
	Eine Aufgabe, die dieser Service-Worker erledigt, ist das sogenannte ``Caching'' von Dateien. Hierbei werden alle zur Offline Benutzung benötigten Resourcen in einem ``Cache'' zwischengespeichert. Somit kann die WebApp größtenteils auch offline verwendet werden.\par
	Da die Entwicklung dieses Teils des Service-Workers oft mit viel reproduktiver Arbeit verbunden ist, haben die Google Chrome Entwickler eine Bibliothek\footnote{\inlinecode{sw-precache} - GitHub: \url{https://github.com/GoogleChrome/sw-precache}} zur Verfügung gestellt. Mit dieser lässt sich nach eingestellten Regeln ein Service-Worker erstellen, der alle benötigten Resourcen ``cachet''. Somit muss auf dem Entwicklungsrechner lediglich ein lokales Skript ausgeführt werden, welches alle zu cachenden Dateien im Service-Worker verlinkt.\par
	Eine weitere Aufgabe des Service-Workers besteht darin, Push-Be\-nach\-rich\-ti\-gungen zu verwalten. Hierbei muss der Benutzer erst bestätigen, dass dieser Nachrichten erhalten darf. Durch eine Bestätigung hat dieser den Push-Dienst abonniert, und erhält ab dann Push-Benachrichtigungen. Diese Bestätigung kann jederzeit wieder zurückgenommen werden, falls zum Beispiel jene den Benutzer stören.\par
	
	\subsubsection{View-Klasse: Account Einstellungen}
	Durch ECMA-Script 2015 und 2016, kurz ECMA-Script 6 oder ES6, ist es möglich ``echte'' Klassen in JS zu schreiben. Diese werden ähnlich zu anderen Programmiersprachen so definiert:\par
	\begin{minted}{js}
class Rectangle {
    constructor(height, width) {
        this.height = height;
        this.width = width;
    }
}
	\end{minted}
	Als ersten Teil wird sich nun die ``Account Einstellungen''-Seite vorgenommen, hier kann später neben Änderungen am Passwort und der Email-Adresse und anderen Optionen auch die Erlaubnis zum Senden bzw. Empfangen von Push-Be\-nach\-rich\-ti\-gungen gegeben, oder auch zurückgezogen werden.\par
	Um eine gute Struktur im JS zu behalten, wird sich an den zuvor erklärten ES6-Klassen bedient. Für jeden ``View'', also jede Unterseite, wird eine eigene ``View-Klasse'' erstellt. Diese beinhaltet, im Gegensatz zu Standart-Klassen, keine Daten, sondern beherbergt Methoden und Eigenschaften der Darstellung dieser Unterseite.\par
	Im Konstruktur werden alle Daten gesammelt die schon vor dem Ausführen der Unterseite benötigt werden. Hierzu gehört unter anderem das Kompilieren der Handlebars-Templates. Diese sind eine HTML-Blaupause und können später mit Daten gefüllt werden und mittels DOM-Manipulation angezeigt werden.\par
	
	\subsubsection{Synchronisierung mit dem Server}
	Um Offline-Funktionalität gewehrleisten zu können, werden alle Aktionen die der Benutzer in der WebApp ausführt zunächst in der lokalen Datenbank ausgeführt. Außerdem wird gespeichert, welche Aktion der Benutzer in welcher Reihenfolge getan hat. Diese Aktionen werden daraufhin, beziehungsweise sobald der Benutzer wieder mit dem Internet verbunden ist, an den Server gesendet um auf der serverseitigen Datenbank ausgeführt zu werden. Der Server sendet nach erfolgreicher Ausführung die aktuellen Daten an den Client zurück. Dieser ersetzt die alten Daten in der lokalen Datenbank durch die neuen vom Server.\par
	\newpage
	\section{Anhang}
	\subsection{Literaturverzeichnis}
	\printbibliography[heading=none]
	
	\subsection{Quellcode}
	To follow
	
	\newpage
	\section{Erklärung über die selbstständige Anfertigung der Arbeit}
	Hiermit erkläre ich, dass ich die vorliegende Hausarbeit selbständig verfasst und keine anderen als die angegebenen Hilfsmittel benutzt habe.
	Die Stellen der Hausarbeit, die anderen Quellen im Wortlaut oder dem Sinn nach entnommen wurden, sind durch Angaben der Herkunft kenntlich gemacht. Dies gilt auch für Zeichnungen, Skizzen, bildliche Darstellungen sowie für Quellen aus dem Internet.\cite{erklaerung}\par
	\vspace{0.5cm}
	\noindent Mainz, den 24. April 2017\par
	\vspace{2cm}
	\noindent Yannick F\'{e}lix
	\vfill
	\doclicenseThis

\end{document}               % End of document.